(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[130],{1568:function(t,e,n){"use strict";n.r(e),n.d(e,{default:function(){return p}});var o=n(29),a=n(7794),c=n.n(a),i=n(7294),s=n(9669),u=n.n(s),r=n(6447),l=n(9800),d=n(5893);function p(){var t=(0,i.useState)([]),e=t[0],n=t[1],a=(0,i.useState)(0),s=a[0],p=a[1],f=(0,i.useState)(0),h=f[0],x=f[1],v=(0,i.useState)(0),g=v[0],j=v[1],b=(0,i.useState)(0),k=b[0],w=b[1],m=(0,i.useState)(!1),S=m[0],_=m[1],C=(0,i.useState)("jpg"),M=C[0],y=C[1],I=(0,i.useState)("maoquanji28"),B=I[0],E=I[1],N=(0,i.useState)(!0),z=N[0],P=N[1],V=(0,i.useState)("archives0/mao-quanji/28-OCR.pdf"),O=V[0],X=V[1],F=(0,i.useState)("13-13"),T=F[0],q=F[1],R=(0,i.useState)(1500),U=R[0],Y=R[1],Z=(0,i.useCallback)((0,o.Z)(c().mark(function t(){var e,o,a,i,s;return c().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e=parseInt(T.split("-")[0]),o=parseInt(T.split("-")[1]),a=[],i=e;case 4:if(!(i<=o)){t.next=12;break}return t.next=7,u().get("http://localhost:8099?resize=".concat(U,"&cache=").concat(S?"false":"true","&id=").concat(B,"&page=").concat(i,"&").concat(z?"pdf_path=".concat(encodeURIComponent(O)):"img_ext=".concat(M)));case 7:s=t.sent,a.push(s.data);case 9:++i,t.next=4;break;case 12:n(a);case 13:case"end":return t.stop()}},t)})),[B,T,S,U,M,z,O]);(0,i.useEffect)(function(){Z()},[]);var A=parseInt(T.split("-")[0]),D=Array(parseInt(T.split("-")[1])-A+1).fill(0).map(function(t,n){var o,a,c;return(0,d.jsxs)("div",{style:{position:"relative"},onMouseMove:function(t){j(Math.floor(t.clientX)),w(Math.floor(t.clientY)),p(Math.floor(t.pageX)),x(Math.floor(t.pageY))},children:[(0,d.jsxs)("div",{style:{position:"fixed",left:g+20,top:k,zIndex:4},children:[s,",",h]}),z?(0,d.jsx)(l.T3,{pageNumber:n+A,height:null===(o=e[n])||void 0===o?void 0:o.dimensions.height,width:null===(a=e[n])||void 0===a?void 0:a.dimensions.width}):(0,d.jsx)("img",{src:"/books/".concat(B,"/").concat(n+A,".").concat(M)}),null===(c=e[n])||void 0===c?void 0:c.ocr_results.map(function(t){return(0,d.jsx)("div",{style:{position:"absolute",left:t.box[0][0],background:"rgba(0, 255, 0, 0.3)",width:t.box[1][0]-t.box[0][0],top:t.box[0][1],fontSize:19,color:"white",whiteSpace:"nowrap",textShadow:"-1px 4px 2px black",height:t.box[2][1]-t.box[0][1]},children:t.text},Math.random())})]},"".concat(z,"-").concat(O,"-").concat(B,"-").concat(n,"-").concat(M).concat(S))});return(0,d.jsxs)(r.Z,{sx:{height:"100%",overflow:"scroll"},children:[(0,d.jsxs)("div",{style:{width:100,height:400,position:"fixed",bottom:10,left:10,zIndex:3},children:["noCache:",(0,d.jsx)("input",{type:"checkbox",checked:S,onChange:function(){return _(!S)}}),"isPDF:",(0,d.jsx)("input",{type:"checkbox",checked:z,onChange:function(){return P(!z)}}),"id:",(0,d.jsx)("input",{defaultValue:B,onBlur:function(t){E(t.target.value)}}),z?(0,d.jsxs)(d.Fragment,{children:["pdfPath:",(0,d.jsx)("input",{defaultValue:O,onBlur:function(t){X(t.target.value)}})]}):(0,d.jsxs)("div",{children:["ext:",(0,d.jsx)("input",{defaultValue:M,onBlur:function(t){y(t.target.value)}})]}),"range:",(0,d.jsx)("input",{defaultValue:T,onBlur:function(t){q(t.target.value)}}),"size:",(0,d.jsx)("input",{defaultValue:U,onBlur:function(t){Y(parseInt(t.target.value))}}),(0,d.jsx)("button",{onClick:function(){return Z()},children:"update"})]}),z?(0,d.jsx)(l.BB,{file:"/books/".concat(O),options:{cMapUrl:"/pdfjs-dist/cmaps/",cMapPacked:!0},children:D}):(0,d.jsx)(d.Fragment,{children:D})]})}l.v0.GlobalWorkerOptions.workerSrc="/pdfjs-dist/legacy/build/pdf.worker.min.js"},3609:function(t,e,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/ocr",function(){return n(1568)}])},4601:function(){},2767:function(){},8251:function(){},7677:function(){},7324:function(){}},function(t){t.O(0,[824,563,679,106,774,888,179],function(){return t(t.s=3609)}),_N_E=t.O()}]);