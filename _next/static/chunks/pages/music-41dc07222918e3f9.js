(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[621],{6293:function(n,e,t){"use strict";t.d(e,{Z:function(){return o}});var r=t(5861),i=t(5893);function o(n){var e=n.diff;return e?(0,i.jsx)(i.Fragment,{children:e.map(function(n,e){return(0,i.jsx)(r.Z,{variant:"body1",sx:{margin:.5},children:n.map(function(n,e){return(0,i.jsx)("span",{style:{color:1===n[0]?"green":-1===n[0]?"red":"inherit"},children:n[1]},e)})},e)})}):null}},5578:function(n,e,t){"use strict";t.d(e,{Z:function(){return R}});var r=t(6447),i=t(7294),o=t(9499),s=t(948),a=t(1796),l=t(8462),c=t(7212),u=t(8619),h=t(9334),f=t(8780),d=t(326),x=t(2293),p=t(7357),m=t(7533),g=t(155),j=t(5861),v=t(3156),y=t(1057),Z=t(7600),b=t(1163),w=t(5449),k=t(787),C=t(3946),P=t(2761),S=t(5893),_=(0,s.ZP)("div")(function(n){var e=n.theme;return(0,o.Z)({position:"relative",borderRadius:e.shape.borderRadius,backgroundColor:(0,a.Fq)(e.palette.common.white,.15),"&:hover":{backgroundColor:(0,a.Fq)(e.palette.common.white,.25)},marginRight:e.spacing(2),marginLeft:0,width:"100%"},e.breakpoints.up("sm"),{marginLeft:e.spacing(3),width:"auto"})}),E=(0,s.ZP)("div")(function(n){return{padding:n.theme.spacing(0,2),height:"100%",position:"absolute",pointerEvents:"none",display:"flex",alignItems:"center",justifyContent:"center"}}),I=(0,s.ZP)(k.ZP)(function(n){var e=n.theme;return{color:"inherit","& .MuiInputBase-input":(0,o.Z)({padding:e.spacing(1,1,1,0),paddingLeft:"calc(1em + ".concat(e.spacing(4),")"),transition:e.transitions.create("width"),width:"100%"},e.breakpoints.up("md"),{width:"20ch"})}}),M=[{name:"首页",path:"/"},{name:"文稿",path:"/articles"},{name:"音乐",path:"/music"},{name:"图库",path:"/gallery"}];function N(){var n=(0,b.useRouter)(),e=(0,i.useState)(""),t=e[0],o=e[1],s=(0,i.useState)(!1),a=s[0],k=s[1],N=function(){k(!a)},O=(0,S.jsx)(p.Z,{onClick:N,sx:{textAlign:"center"},children:(0,S.jsx)(l.Z,{children:M.map(function(n){return(0,S.jsx)(c.ZP,{disablePadding:!0,children:(0,S.jsx)(u.Z,{sx:{textAlign:"center"},href:n.path,target:"_blank",children:(0,S.jsx)(h.Z,{primary:n.name})})},n.name)})})});return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(x.Z,{position:"static",children:(0,S.jsx)(v.Z,{maxWidth:"xl",children:(0,S.jsxs)(g.Z,{disableGutters:!0,children:[(0,S.jsxs)(r.Z,{sx:{position:"relative",ml:1,transform:"translateY(4px)"},children:[(0,S.jsx)(f.Z,{sx:{width:20,position:"absolute",bottom:"50%",left:"50%",transform:"translateX(-50%)"}}),(0,S.jsx)(Z.Z,{})]}),(0,S.jsx)(j.Z,{variant:"h6",noWrap:!0,component:"a",sx:{ml:1,mr:2,fontWeight:700,letterSpacing:".3rem",textDecoration:"none",cursor:"pointer"},style:{color:"white"},href:"/",onClick:function(){return n.push("/")},children:"和谐历史档案馆"}),(0,S.jsxs)(_,{sx:{display:{xs:"none",sm:"none",md:"flex",lg:"flex",xl:"flex"}},children:[(0,S.jsx)(E,{children:(0,S.jsx)(P.Z,{})}),(0,S.jsx)(I,{placeholder:"全站搜索",onKeyDown:function(e){if("Enter"===e.key){if("localhost"===location.hostname){n.push({pathname:"/search/[keyword]",query:{keyword:t}});return}window.open("https://duckduckgo.com?q="+encodeURIComponent("site:banned-historical-archives.github.io "+t),"_blank")}},value:t,onChange:function(n){return o(n.target.value)},inputProps:{"aria-label":"search"}})]}),(0,S.jsx)(r.Z,{sx:{flex:1}}),(0,S.jsxs)(r.Z,{sx:{display:{xs:"none",sm:"flex"}},direction:"row",justifyContent:"flex-end",children:[M.map(function(e){var t=e.name,r=e.path;return(0,S.jsx)(y.Z,{sx:{color:"white"},onClick:function(){return n.push(r)},children:t},r)}),(0,S.jsxs)(y.Z,{href:"https://github.com/banned-historical-archives/banned-historical-archives.github.io/issues",target:"_blank",sx:{color:"white"},children:[(0,S.jsx)(w.Z,{sx:{mr:1}}),"讨论"]})]}),(0,S.jsx)(C.Z,{size:"small",edge:"start",color:"inherit","aria-label":"menu",sx:{display:{xs:"flex",sm:"none"}},onClick:N,children:(0,S.jsx)(d.Z,{})})]})})}),(0,S.jsx)(p.Z,{component:"nav",children:(0,S.jsx)(m.ZP,{variant:"temporary",anchor:"right",open:a,onClose:N,ModalProps:{keepMounted:!0},sx:{display:{xs:"block",sm:"none"},"& .MuiDrawer-paper":{boxSizing:"border-box",width:240}},children:O})})]})}function O(){return null}var T=t(8078);function R(n){var e=n.children,t=(0,i.useState)(!1),o=t[0],s=t[1],a=(0,b.useRouter)();return(0,i.useEffect)(function(){var n=function(n){s(!0)},e=function(){s(!1)};return a.events.on("routeChangeStart",n),a.events.on("routeChangeComplete",e),a.events.on("routeChangeError",e),function(){a.events.off("routeChangeStart",n),a.events.off("routeChangeComplete",e),a.events.off("routeChangeError",e)}},[a]),(0,S.jsx)(S.Fragment,{children:(0,S.jsxs)(r.Z,{sx:{position:"absolute",height:"100%",width:"100%"},direction:"column",children:[(0,S.jsx)(N,{}),o?(0,S.jsxs)(r.Z,{spacing:1,p:2,children:[(0,S.jsx)(T.Z,{variant:"text",sx:{fontSize:"1rem"}}),(0,S.jsx)(T.Z,{variant:"rectangular",height:60}),(0,S.jsx)(T.Z,{variant:"rectangular",height:60}),(0,S.jsx)(T.Z,{variant:"rectangular",height:60}),(0,S.jsx)(T.Z,{variant:"rectangular",height:60})]}):(0,S.jsx)("main",{style:{flex:1,position:"relative",overflow:"hidden"},children:e}),(0,S.jsx)(O,{})]})})}},4715:function(n,e,t){"use strict";t.r(e),t.d(e,{__N_SSG:function(){return F},default:function(){return L}});var r,i,o=t(6835),s=t(7294),a=t(9008),l=t.n(a),c=t(2027),u=t(4564),h=t(5397),f=t(6522),d=t(5578),x=t(1236),p=t(837),m=t(8055),g=t(7357),j=t(6323),v=t(629),y=t(8075),Z=t(8360),b=t(1057),w=t(431),k=t(7720),C=t(6447),P=t(2280),S=t(8895),_=t(2797),E=t(5861),I=t(7349),M=t(3508),N=t(6293),O=t(5893);function T(n,e){var t="undefined"!=typeof Symbol&&n[Symbol.iterator]||n["@@iterator"];if(!t){if(Array.isArray(n)||(t=function(n,e){if(n){if("string"==typeof n)return R(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if("Object"===t&&n.constructor&&(t=n.constructor.name),"Map"===t||"Set"===t)return Array.from(n);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return R(n,e)}}(n))||e&&n&&"number"==typeof n.length){t&&(n=t);var r=0,i=function(){};return{s:i,n:function(){return r>=n.length?{done:!0}:{done:!1,value:n[r++]}},e:function(n){throw n},f:i}}throw TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){t=t.call(n)},n:function(){var n=t.next();return s=n.done,n},e:function(n){a=!0,o=n},f:function(){try{s||null==t.return||t.return()}finally{if(a)throw o}}}}function R(n,e){(null==e||e>n.length)&&(e=n.length);for(var t=0,r=Array(e);t<e;t++)r[t]=n[t];return r}function z(n){for(var e=n.song,t=n.setPlayingName,r=n.setPlaying,i=(0,s.useState)(e.lyrics[0].id),o=i[0],a=i[1],l=(0,s.useState)(e.lyrics[e.lyrics.length-1].id),u=l[0],h=l[1],d=e.lyrics.find(function(n){return n.id===o}).content.split("\n"),x=e.lyrics.find(function(n){return n.id===u}).content.split("\n"),p=0,m=Math.max(d.length,x.length),g=[];p<m;){var j=d[p]||"",v=x[p]||"";g.push(new c.diff_match_patch().diff_main(j,v)),++p}return(0,O.jsxs)(P.Z,{disableGutters:!0,children:[(0,O.jsx)(S.Z,{expandIcon:(0,O.jsx)(M.Z,{}),id:e.id,children:(0,O.jsx)(E.Z,{variant:"h6",children:e.name})}),(0,O.jsxs)(_.Z,{children:[(0,O.jsx)(k.Z,{}),(0,O.jsx)(E.Z,{variant:"subtitle1",sx:{mt:2,mb:2},children:"演唱/演奏版本："}),(0,O.jsx)(C.Z,{children:e.lyrics.map(function(n){return(0,O.jsx)(C.Z,{sx:{display:"inline"},children:n.audios.map(function(i){var o="".concat(e.name,"-").concat(n.version,"-").concat(i.artist||"未知");return(0,O.jsx)(b.Z,{sx:{justifyContent:"start"},startIcon:(0,O.jsx)(f.Z,{}),onClick:function(){t(o),r(!0)},children:o},i.id)})},n.id)})}),(0,O.jsx)(k.Z,{sx:{mt:2}}),e.lyrics.length>1?(0,O.jsx)(E.Z,{variant:"subtitle1",sx:{mt:2,mb:2},children:"歌词对比："}):null,(0,O.jsxs)(C.Z,{direction:"row",spacing:2,children:[(0,O.jsxs)(C.Z,{sx:{flex:1},children:[(0,O.jsx)(Z.Z,{size:"small",value:o,label:"版本",sx:{mb:1},onChange:function(n){a(n.target.value)},children:e.lyrics.map(function(n){return(0,O.jsx)(w.Z,{value:n.id,children:n.version},n.id)})}),(0,O.jsx)(C.Z,{children:d.map(function(n,e){return(0,O.jsx)(E.Z,{children:n},e)})})]}),e.lyrics.length>1?(0,O.jsxs)(O.Fragment,{children:[(0,O.jsxs)(C.Z,{sx:{flex:1},children:[(0,O.jsx)(Z.Z,{size:"small",value:u,label:"版本",sx:{mb:1},onChange:function(n){h(n.target.value)},children:e.lyrics.map(function(n){return(0,O.jsx)(w.Z,{value:n.id,children:n.version},n.id)})}),(0,O.jsx)(C.Z,{children:x.map(function(n,e){return(0,O.jsx)(E.Z,{children:n},e)})})]}),(0,O.jsx)(C.Z,{sx:{flex:1},children:(0,O.jsx)(C.Z,{children:(0,O.jsx)(N.Z,{diff:g})})})]}):null]})]})]})}function A(n){n.music;var e=n.playing,t=n.playingName,r=n.setPlaying,a=n.setPlayingName,l=n.playlist,c=n.repeatType,d=n.setRepeatType,Z=s.useState(null),b=(0,o.Z)(Z,2),w=b[0],k=b[1],C=function(n){k(n.currentTarget)},P=function(){k(null)};return(0,O.jsxs)(O.Fragment,{children:[(0,O.jsx)(u.ZP,{id:"music-list",open:!!w,anchorEl:w,disableRestoreFocus:!0,anchorOrigin:{vertical:"top",horizontal:"right"},transformOrigin:{vertical:"bottom",horizontal:"right"},PaperProps:{onMouseLeave:function(){return P()},style:{transform:"translateX(-10px)"}},children:Object.keys(l).map(function(n){return(0,O.jsx)(E.Z,{sx:{p:2,wordWrap:"nowrap",cursor:"pointer",color:n===t?"#cc0000":"inherit"},onClick:function(){P(),a(n),r(!0)},children:n},n)})}),(0,O.jsxs)(g.Z,{sx:{bottom:30,right:30,height:320,position:"fixed",transform:"translateZ(0px)",flexGrow:1,zIndex:20},children:[(0,O.jsx)(v.Z,{sx:{p:2,pt:1,pb:1,pr:4,mr:-2,position:"absolute",bottom:44,transform:"translateY(50%)",zIndex:10,right:70},onClick:C,onMouseEnter:C,children:(0,O.jsx)(E.Z,{sx:{whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden",width:{xs:"200px",sm:"auto"}},children:t})}),(0,O.jsxs)(j.Z,{ariaLabel:"player",sx:{position:"absolute",bottom:16,right:16},onClick:function(){return r(!e)},icon:e?(0,O.jsx)(I.Z,{}):(0,O.jsx)(f.Z,{}),children:[(0,O.jsx)(y.Z,{icon:(0,O.jsx)(h.Z,{}),onClick:function(n){if(n.stopPropagation(),c===i.shuffle){for(var e=Object.keys(l),r=e.findIndex(function(n){return n===t}),o=0;o===r;)o=Math.floor(Math.random()*e.length);a(e[o])}else{var s=Object.keys(l),u=s.findIndex(function(n){return n===t});a(s[u+1<s.length?u+1:0])}},tooltipTitle:"下一首"}),(0,O.jsx)(y.Z,{icon:(0,O.jsx)(m.Z,{sx:{color:c===i.shuffle?"#cc0000":"inherit"}}),onClick:function(n){n.stopPropagation(),d(i.shuffle)},tooltipTitle:"随机播放"}),(0,O.jsx)(y.Z,{icon:(0,O.jsx)(p.Z,{sx:{color:c===i.all?"#cc0000":"inherit"}}),onClick:function(n){n.stopPropagation(),d(i.all)},tooltipTitle:"顺序播放"}),(0,O.jsx)(y.Z,{icon:(0,O.jsx)(x.Z,{sx:{color:c===i.one?"#cc0000":"inherit"}}),onClick:function(n){n.stopPropagation(),d(i.one)},tooltipTitle:"单曲循环"})]})]})]})}(r=i||(i={}))[r.all=0]="all",r[r.shuffle=1]="shuffle",r[r.one=2]="one";var F=!0;function L(n){var e,t=n.music,r=(0,s.useState)(!1),o=r[0],a=r[1],c=(0,s.useState)(i.shuffle),u=c[0],h=c[1],f=(0,s.useState)("".concat(t[0].name,"-").concat(t[0].lyrics[0].version,"-").concat(t[0].lyrics[0].audios[0].artist||"未知")),d=f[0],x=f[1],p=(0,s.useRef)(null),m={},g=T(t);try{for(g.s();!(e=g.n()).done;){var j,v=e.value,y=T(v.lyrics);try{for(y.s();!(j=y.n()).done;){var Z,b=j.value,w=T(b.audios);try{for(w.s();!(Z=w.n()).done;){var k=Z.value;m["".concat(v.name,"-").concat(b.version,"-").concat(k.artist||"未知")]=k.url}}catch(n){w.e(n)}finally{w.f()}}}catch(n){y.e(n)}finally{y.f()}}}catch(n){g.e(n)}finally{g.f()}return(0,s.useEffect)(function(){p.current&&(o?p.current.play().catch(function(){}):p.current.pause())},[o]),(0,s.useEffect)(function(){p.current&&o&&(p.current.src=m[d],p.current.play().catch(function(){}))},[d,o,m]),(0,O.jsxs)(C.Z,{p:2,sx:{height:"100%",overflow:"scroll"},children:[(0,O.jsx)(l(),{children:(0,O.jsx)("title",{children:"和谐历史档案馆 Banned Historical Archives"})}),(0,O.jsx)(E.Z,{variant:"h4",sx:{mb:1},children:"音乐"}),(0,O.jsx)(E.Z,{variant:"body1",sx:{mb:1},children:"多媒体资料包括音乐及歌词、电影、照片、录音等。目前主要收录社会主义中国创作的红色音乐。"}),(0,O.jsx)("audio",{ref:p,onEnded:function(){if(u===i.one)p.current.play().catch(function(){});else if(u===i.all){var n=Object.keys(m),e=n.findIndex(function(n){return n===d});x(n[e+1<n.length?e+1:0])}else if(u===i.shuffle){for(var t=Object.keys(m),r=t.findIndex(function(n){return n===d}),o=0;o===r;)o=Math.floor(Math.random()*t.length);x(t[o])}},src:m[d],style:{position:"fixed",left:"100%"}}),(0,O.jsx)(A,{music:t,playing:o,playlist:m,repeatType:u,setPlaying:a,setRepeatType:h,setPlayingName:x,playingName:d}),t.map(function(n){return(0,O.jsx)(z,{song:n,setPlayingName:x,setPlaying:a},n.id)})]})}L.getLayout=function(n){return(0,O.jsx)(d.Z,{children:n})}},2095:function(n,e,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/music",function(){return t(4715)}])}},function(n){n.O(0,[563,810,598,386,51,612,774,888,179],function(){return n(n.s=2095)}),_N_E=n.O()}]);